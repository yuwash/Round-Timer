$(document).ready(function(){"use strict";var a={totalRounds:0,roundMinutes:0,roundSeconds:0,restSeconds:0,restMinutes:0,p:10},b=!1,c=null,d=document.getElementById("bell"),e=document.getElementById("ten"),f=document.getElementById("gong");!function(a){a.fn.bidigitNumber=function(a){return a%=100,this.text(10>a?"0"+a:a),this}}(jQuery);var g=function(a,b){this.minutesElement=a,this.secondsElement=b};g.prototype.setMinutes=function(a){this.minutesElement.bidigitNumber(a)},g.prototype.setSeconds=function(a){this.secondsElement.bidigitNumber(a)},g.prototype.getMinutes=function(){return parseInt(this.minutesElement.text())},g.prototype.getSeconds=function(){return parseInt(this.secondsElement.text())};var h=function(a,b){this.timeDisplays=a,this.mobileTimeDisplays=b||[],this.read()};h.prototype.read=function(){window.innerWidth<=600?(this.__minutes=this.mobileTimeDisplays[0].getMinutes(),this.__seconds=this.mobileTimeDisplays[0].getSeconds()):(this.__minutes=this.timeDisplays[0].getMinutes(),this.__seconds=this.timeDisplays[0].getSeconds())},h.prototype.setMinutes=function(a){if(this.__minutes!=a){this.__minutes=a;for(var b in this.timeDisplays)this.timeDisplays[b].setMinutes(a);for(var b in this.mobileTimeDisplays)this.mobileTimeDisplays[b].setMinutes(a)}},h.prototype.setSeconds=function(a){if(this.__seconds!=a){this.__seconds=a;for(var b in this.timeDisplays)this.timeDisplays[b].setSeconds(a);for(var b in this.mobileTimeDisplays)this.mobileTimeDisplays[b].setSeconds(a)}},h.prototype.pullFrom=function(a){if(a.__seconds!=this.__seconds||a.__minutes!=this.__minutes){this.__seconds=a.__seconds,this.__minutes=a.__minutes;for(var b in this.timeDisplays)this.timeDisplays[b].setSeconds(this.__seconds),this.timeDisplays[b].setMinutes(this.__minutes);for(var b in this.mobileTimeDisplays)this.mobileTimeDisplays[b].setSeconds(this.__seconds),this.mobileTimeDisplays[b].setMinutes(this.__minutes)}},h.prototype.getMinutes=function(){return this.__minutes},h.prototype.getSeconds=function(){return this.__seconds},h.prototype.getTotalSeconds=function(){return 60*this.__minutes+this.__seconds},h.prototype.addSeconds=function(a){var b=this.__seconds+a;if(b>=60||0>b){var c=Math.floor(b/60);if(this.setSeconds(b-60*c),c+=this.__minutes,c>=60)c%=60;else if(0>c){var d=Math.floor(c/60);c-=60*d}this.setMinutes(c)}else this.setSeconds(b)},h.prototype.incSeconds=function(){this.addSeconds(1)},h.prototype.incMinutes=function(){this.setMinutes((this.__minutes+1)%60)},h.prototype.decSeconds=function(){this.addSeconds(-1)},h.prototype.decMinutes=function(){this.setMinutes((this.__minutes+59)%60)},h.getTimeWithNewDisplay=function(a,b){var c=new g(a,b),d=new h([c]);return d};var i=function(a,b){this.displayElement=a,this.onChangeFunction=b||function(){},this.read()};i.prototype.read=function(){this.__counter=parseInt(this.displayElement.text()),this.onChangeFunction(this.__counter)},i.prototype.write=function(){this.displayElement.text(this.__counter)},i.prototype.get=function(){return this.__counter},i.prototype.set=function(a){this.__counter!=a&&(this.__counter=a,this.write(),this.onChangeFunction(this.__counter))},i.prototype.inc=function(){this.__counter++,this.write(),this.onChangeFunction(this.__counter)},i.prototype.dec=function(){this.__counter--,this.write(),this.onChangeFunction(this.__counter)};var j=h.getTimeWithNewDisplay($("#round-time #r-minutes"),$("#round-time #r-seconds")),k=h.getTimeWithNewDisplay($("#rest #rt-minutes"),$("#rest #rt-seconds")),l=h.getTimeWithNewDisplay($("#tminutes"),$("#tseconds"));j.mobileTimeDisplays.push(new g($("mobile-round-minutes"),$("mobile-round-seconds"))),k.mobileTimeDisplays.push(new g($("mobile-rest-minutes"),$("mobile-rest-seconds"))),j.timeDisplays.push(l.timeDisplays[0]);var m=new i($("#total-rounds")),n=new i($("#rounds")),o=new i($("#ptimer"));$("#rounds .plus").click(function(){m.read(),m.inc()}),$("#rounds .minus").click(function(){m.read(),m.get()>0&&m.dec()}),$("#round-time .plus").click(function(){j.incSeconds()}),$("#round-time .minus").click(function(){j.decSeconds()}),$("#round-time .plus-minutes").click(function(){j.incMinutes()}),$("#round-time .minus-minutes").click(function(){j.decMinutes()}),$("#rest .plus").click(function(){k.incSeconds()}),$("#rest .minus").click(function(){k.decSeconds()}),$("#rest .plus-minutes").click(function(){k.incMinutes()}),$("#rest .minus-minutes").click(function(){k.decMinutes()}),$(".mobile-round-count").change(function(){m.set(parseInt($(this).val())),console.log(totalRounds)}),$(".mobile-round-minutes").change(function(){roundMinutes=parseInt($(this).val()),j.setMinutes(roundMinutes),console.log(roundMinutes)}),$(".mobile-round-seconds").change(function(){roundSeconds=parseInt($(this).val()),j.setSeconds(roundSeconds),console.log(roundSeconds)}),$(".mobile-rest-minutes").change(function(){restMinutes=parseInt($(this).val()),k.setMinutes(restMinutes),console.log(restMinutes)}),$(".mobile-rest-seconds").change(function(){restSeconds=parseInt($(this).val()),k.setSeconds(restSeconds),console.log(seconds)}),$("#stop").click(function(){location.reload()}),$("#start").click(function(){if(0==m.get())alert("You must set the number of rounds");else{$("#start").hide(),$("#prepare").css("margin-left","0"),o.set(a.p);var b=setInterval(function(){o.dec(),0==o.get()&&($("#prepare").css("margin-left","-9999px"),clearInterval(b),d.play(),t(),u())},1e3)}});var p=function(){l.getTotalSeconds()>0&&(l.decSeconds(),10==l.getTotalSeconds()&&e.play())},q=function(){f.play(),n.dec(),b=!0,l.pullFrom(k),$("#round-counter").css("background-color","red")},r=function(){t(),alert("Session Over!"),$("#start").show()},c=function(){l.decSeconds()},s=function(){b=!1,l.pullFrom(j),$("#round-counter").css("background-color","white"),d.play()},t=function(){$("#round-counter").css("background-color","white"),j.read(),k.read(),m.read(),l.pullFrom(j),n.set(m.get())},u=function(){var a=setInterval(function(){l.getTotalSeconds()>0?b?c():p():n.get()<=0?(clearInterval(a),r()):b?s():q()},1e3)}});