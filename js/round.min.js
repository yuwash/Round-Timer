$(document).ready(function(){"use strict";var a={totalRounds:0,roundMinutes:0,roundSeconds:0,restSeconds:0,restMinutes:0,p:10,doPrepare:!0},b=!1,c=!1,d=a.doPrepare,e=document.getElementById("bell"),f=document.getElementById("ten"),g=document.getElementById("gong");!function(a){a.fn.bidigitNumber=function(a){return a%=100,this.text(10>a?"0"+a:a),this}}(jQuery);var h=function(a,b,c){this.minutesElement=a,this.secondsElement=b,this.useSelect=1==c};h.prototype.setMinutes=function(a){this.useSelect||this.minutesElement.bidigitNumber(a)},h.prototype.setSeconds=function(a){this.useSelect||this.secondsElement.bidigitNumber(a)},h.prototype.getMinutes=function(){return parseInt(this.useSelect?this.minutesElement.va():this.minutesElement.text())},h.prototype.getSeconds=function(){return parseInt(this.useSelect?this.secondsElement.val():this.minutesElement.text())};var i=function(a,b){this.timeDisplays=a,this.mobileTimeDisplays=b||[],this.read()};i.prototype.read=function(){window.innerWidth<=600&&this.mobileTimeDisplays[0]?(this.__minutes=this.mobileTimeDisplays[0].getMinutes(),this.__seconds=this.mobileTimeDisplays[0].getSeconds()):(this.__minutes=this.timeDisplays[0].getMinutes(),this.__seconds=this.timeDisplays[0].getSeconds())},i.prototype.setMinutes=function(a){if(this.__minutes!=a){this.__minutes=a;for(var b in this.timeDisplays)this.timeDisplays[b].setMinutes(a);for(var b in this.mobileTimeDisplays)this.mobileTimeDisplays[b].setMinutes(a)}},i.prototype.setSeconds=function(a){if(this.__seconds!=a){this.__seconds=a;for(var b in this.timeDisplays)this.timeDisplays[b].setSeconds(a);for(var b in this.mobileTimeDisplays)this.mobileTimeDisplays[b].setSeconds(a)}},i.prototype.pullFrom=function(a){if(a.__seconds!=this.__seconds||a.__minutes!=this.__minutes){this.__seconds=a.__seconds,this.__minutes=a.__minutes;for(var b in this.timeDisplays)this.timeDisplays[b].setSeconds(this.__seconds),this.timeDisplays[b].setMinutes(this.__minutes);for(var b in this.mobileTimeDisplays)this.mobileTimeDisplays[b].setSeconds(this.__seconds),this.mobileTimeDisplays[b].setMinutes(this.__minutes)}},i.prototype.getMinutes=function(){return this.__minutes},i.prototype.getSeconds=function(){return this.__seconds},i.prototype.getTotalSeconds=function(){return 60*this.__minutes+this.__seconds},i.prototype.addSeconds=function(a){var b=this.__seconds+a;if(b>=60||0>b){var c=Math.floor(b/60);if(this.setSeconds(b-60*c),c+=this.__minutes,c>=60)c%=60;else if(0>c){var d=Math.floor(c/60);c-=60*d}this.setMinutes(c)}else this.setSeconds(b)},i.prototype.incSeconds=function(){this.addSeconds(1)},i.prototype.incMinutes=function(){this.setMinutes((this.__minutes+1)%60)},i.prototype.decSeconds=function(){this.addSeconds(-1)},i.prototype.decMinutes=function(){this.setMinutes((this.__minutes+59)%60)},i.getTimeWithNewDisplay=function(a,b,c,d){var e=new h(a,b);if(c&&d){var f=new h(c,d);return new i([e],[f])}return new i([e])};var j=function(a,b){this.displayElement=a,this.onChangeFunction=b||function(){},this.read()};j.prototype.read=function(){this.__counter=parseInt(this.displayElement.text()),this.onChangeFunction(this.__counter)},j.prototype.write=function(){this.displayElement.text(this.__counter)},j.prototype.get=function(){return this.__counter},j.prototype.set=function(a){this.__counter!=a&&(this.__counter=a,this.write(),this.onChangeFunction(this.__counter))},j.prototype.inc=function(){this.__counter++,this.write(),this.onChangeFunction(this.__counter)},j.prototype.dec=function(){this.__counter--,this.write(),this.onChangeFunction(this.__counter)};var k=i.getTimeWithNewDisplay($("#round-time #r-minutes"),$("#round-time #r-seconds"),$("#mobile-round-minutes"),$("#mobile-round-seconds")),l=i.getTimeWithNewDisplay($("#rest #rt-minutes"),$("#rest #rt-seconds"),$("#mobile-rest-minutes"),$("#mobile-rest-seconds")),m=i.getTimeWithNewDisplay($("#tminutes"),$("#tseconds"));k.timeDisplays.push(m.timeDisplays[0]);var n=new j($("#total-rounds")),o=new j($("#remaining-rounds")),p=new j($("#ptimer"));n.set(a.totalRounds),k.setMinutes(a.roundMinutes),k.setSeconds(a.roundSeconds),l.setMinutes(a.restMinutes),l.setSeconds(a.restSeconds),$("#rounds .plus").click(function(){n.read(),n.inc()}),$("#rounds .minus").click(function(){n.read(),n.get()>0?n.dec():alert("Rounds can not be negative!")}),$("#round-time .plus").click(function(){k.incSeconds()}),$("#round-time .minus").click(function(){k.decSeconds()}),$("#round-time .plus-minutes").click(function(){k.incMinutes()}),$("#round-time .minus-minutes").click(function(){k.decMinutes()}),$("#rest .plus").click(function(){l.incSeconds()}),$("#rest .minus").click(function(){l.decSeconds()}),$("#rest .plus-minutes").click(function(){l.incMinutes()}),$("#rest .minus-minutes").click(function(){l.decMinutes()}),$(".mobile-round-count").change(function(){n.set(parseInt($(this).val())),console.log(n.get())}),$(".mobile-round-minutes").change(function(){k.setMinutes(parseInt($(this).val())),console.log(k.getMinutes())}),$(".mobile-round-seconds").change(function(){k.setSeconds(parseInt($(this).val())),console.log(k.getSeconds())}),$(".mobile-rest-minutes").change(function(){l.setMinutes(parseInt($(this).val())),console.log(l.getMinutes())}),$(".mobile-rest-seconds").change(function(){l.setSeconds(parseInt($(this).val())),console.log(l.getSeconds())}),$("#stop").click(function(){location.reload()}),$("#start").click(function(){w()}),$("#prepare-toggle").change(function(){d=$("#prepare-toggle").prop("checked")});var q=function(){$("#total-rounds").css("display","none"),$("#remaining-rounds").css("display","inline"),$("#start").attr("disabled","disabled"),$("#ptimer").css("display","inline"),$("#time").css("display","none"),$("#round-counter").css("background-color","yellow"),o.set(n.get()),d?(p.set(a.p),c=!0):r()},r=function(){$("#ptimer").css("display","none"),$("#time").css("display","inline"),e.play(),u()},s=function(){g.play(),o.dec(),b=!0,$("#round-counter").css("background-color","red")},t=function(){u(),e.play()},u=function(){$("#round-counter").removeAttr("style"),b=!1,c=!1,m.pullFrom(k)},v=function(){u(),o.set(n.get()),alert("Session Over!"),$("#start").removeAttr("disabled"),$("#total-rounds").css("display","inline"),$("#remaining-rounds").css("display","none")},w=function(){if(0==n.get())return void alert("You must set the number of rounds");u(),q();var a=setInterval(function(){c?(p.dec(),0==p.get()&&r()):m.getTotalSeconds()>0?(m.decSeconds(),b||10!=m.getTotalSeconds()||f.play()):o.get()<=0?(clearInterval(a),v()):b?t():s()},1e3)}});